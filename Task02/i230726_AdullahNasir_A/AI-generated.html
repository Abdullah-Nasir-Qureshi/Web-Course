<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Archer Game</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #222;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    #controls {
        margin: 10px;
    }

    button {
        padding: 6px 12px;
        margin: 0 5px;
        font-size: 14px;
        cursor: pointer;
    }

    #score {
        font-size: 20px;
        margin: 5px;
    }

    canvas {
        background: #87CEEB;
        border: 3px solid #333;
    }
</style>
</head>
<body>

<div id="score">Score: 0</div>

<div id="controls">
    <button id="startBtn">Start</button>
    <button id="stopBtn">Stop</button>
    <button id="speedUp">Speed +</button>
    <button id="speedDown">Speed -</button>
</div>

<canvas id="gameCanvas" width="900" height="500"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let score = 0;
let gameRunning = false;

// Archer
const archer = {
    x: 100,
    y: canvas.height / 2
};

// Arrow
let arrow = null;

// Target
const target = {
    x: canvas.width - 100,
    y: 100,
    radius: 25,
    speed: 2,
    direction: 1
};

// Mouse angle
let mouseX = 0;
let mouseY = 0;

// Controls
document.getElementById("startBtn").onclick = () => gameRunning = true;
document.getElementById("stopBtn").onclick = () => gameRunning = false;
document.getElementById("speedUp").onclick = () => target.speed += 1;
document.getElementById("speedDown").onclick = () => {
    if (target.speed > 1) target.speed -= 1;
};

canvas.addEventListener("mousemove", e => {
    const rect = canvas.getBoundingClientRect();
    mouseX = e.clientX - rect.left;
    mouseY = e.clientY - rect.top;
});

canvas.addEventListener("click", shootArrow);

// Shoot arrow
function shootArrow() {
    if (arrow) return;

    const angle = Math.atan2(mouseY - archer.y, mouseX - archer.x);
    arrow = {
        x: archer.x,
        y: archer.y,
        angle: angle,
        speed: 8
    };
}

// Update game
function update() {
    if (gameRunning) {
        // Move target
        target.y += target.speed * target.direction;
        if (target.y < 50 || target.y > canvas.height - 50) {
            target.direction *= -1;
        }
    }

    // Move arrow
    if (arrow) {
        arrow.x += Math.cos(arrow.angle) * arrow.speed;
        arrow.y += Math.sin(arrow.angle) * arrow.speed;

        // Collision detection
        const dx = arrow.x - target.x;
        const dy = arrow.y - target.y;
        const distance = Math.sqrt(dx * dx + dy * dy);

        if (distance < target.radius) {
            score++;
            document.getElementById("score").innerText = "Score: " + score;
            arrow = null;
        }

        // Remove arrow if out of bounds
        if (
            arrow &&
            (arrow.x < 0 || arrow.x > canvas.width ||
             arrow.y < 0 || arrow.y > canvas.height)
        ) {
            arrow = null;
        }
    }
}

// Draw game
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Archer
    ctx.fillStyle = "brown";
    ctx.fillRect(archer.x - 10, archer.y - 20, 20, 40);

    // Bow line (aim direction)
    ctx.strokeStyle = "black";
    ctx.beginPath();
    ctx.moveTo(archer.x, archer.y);
    ctx.lineTo(mouseX, mouseY);
    ctx.stroke();

    // Arrow
    if (arrow) {
        ctx.strokeStyle = "black";
        ctx.beginPath();
        ctx.moveTo(arrow.x, arrow.y);
        ctx.lineTo(
            arrow.x - Math.cos(arrow.angle) * 20,
            arrow.y - Math.sin(arrow.angle) * 20
        );
        ctx.stroke();
    }

    // Target
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.arc(target.x, target.y, target.radius, 0, Math.PI * 2);
    ctx.fill();
}

// Game loop
function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
